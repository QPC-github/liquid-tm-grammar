{
  "name": "Liquid HTML",
  "scopeName": "text.html.liquid",
  "fileTypes": [
    "liquid"
  ],
  "foldingStartMarker": "(?x)\n{%\n  -?\n  \\s*\n  (case|comment|for|form|if|javascript|paginate|schema|style)\n  [^(%})]+\n%}\n",
  "foldingStopMarker": "(?x)\n{%\n  \\s*\n  (endcase|endcomment|endfor|endform|endif|endjavascript|endpaginate|endschema|endstyle)\n  [^(%})]+\n%}\n",
  "patterns": [
    {
      "include": "#comment_block"
    },
    {
      "include": "#comment_inline"
    },
    {
      "begin": "{%-?\\s*(style)\\s*-?%}",
      "end": "{%-?\\s*(endstyle)\\s*-?%}",
      "beginCaptures": {
        "0": {
          "name": "meta.tag.metadata.style.start.liquid"
        },
        "1": {
          "name": "entity.name.tag.liquid"
        }
      },
      "endCaptures": {
        "0": {
          "name": "meta.tag.metadata.style.end.liquid"
        },
        "1": {
          "name": "entity.name.tag.liquid"
        }
      },
      "name": "meta.style.block.todo",
      "contentName": "meta.embedded.block.css",
      "patterns": [
        {
          "include": "source.css"
        }
      ]
    },
    {
      "begin": "{%-?\\s*(schema)\\s*-?%}",
      "end": "{%-?\\s*(endschema)\\s*-?%}",
      "beginCaptures": {
        "0": {
          "name": "meta.tag.metadata.schema.start.liquid"
        },
        "1": {
          "name": "entity.name.tag.liquid"
        }
      },
      "endCaptures": {
        "0": {
          "name": "meta.tag.metadata.schema.end.liquid"
        },
        "1": {
          "name": "entity.name.tag.liquid"
        }
      },
      "name": "meta.block.schema.liquid",
      "contentName": "meta.embedded.block.json",
      "patterns": [
        {
          "include": "source.json"
        }
      ]
    },
    {
      "begin": "{%-?\\s*(javascript)\\s*-?%}",
      "end": "{%-?\\s*(endjavascript)\\s*-?%}",
      "beginCaptures": {
        "0": {
          "name": "meta.tag.metadata.javascript.start.liquid"
        },
        "1": {
          "name": "entity.name.tag.liquid"
        }
      },
      "endCaptures": {
        "0": {
          "name": "meta.tag.metadata.javascript.end.liquid"
        },
        "1": {
          "name": "entity.name.tag.liquid"
        }
      },
      "name": "meta.block.javascript.liquid",
      "contentName": "meta.embedded.block.js",
      "patterns": [
        {
          "include": "source.js"
        }
      ]
    },
    {
      "include": "#object"
    },
    {
      "include": "#tag"
    },
    {
      "include": "text.html.basic"
    }
  ],
  "repository": {
    "comment_block": {
      "begin": "{%-?\\s*comment\\s*-?%}",
      "end": "{%-?\\s*endcomment\\s*-?%}",
      "name": "comment.block.liquid"
    },
    "comment_inline": {
      "begin": "{%-?\\s*#",
      "end": "-?%}",
      "name": "comment.line.number-sign.liquid"
    },
    "tag": {
      "begin": "{%-?",
      "end": "-?%}",
      "name": "meta.braces.liquid",
      "beginCaptures": {
        "0": {
          "name": "punctuation.section.braces.begin.tag.liquid"
        }
      },
      "endCaptures": {
        "0": {
          "name": "punctuation.section.braces.end.tag.liquid"
        }
      },
      "patterns": [
        {
          "include": "#tag_body"
        }
      ]
    },
    "tag_injection": {
      "begin": "{%-?(?!\\s*(endstyle|endjavascript|endcomment))",
      "end": "-?%}",
      "name": "punctuation.tag.liquid",
      "beginCaptures": {
        "0": {
          "name": "meta.embedded.punctuation.definition.block.liquid.tag"
        }
      },
      "endCaptures": {
        "0": {
          "name": "meta.embedded.punctuation.definition.block.liquid.tag"
        }
      },
      "patterns": [
        {
          "include": "#tag_body"
        }
      ]
    },
    "tag_body": {
      "patterns": [
        {
          "include": "#template_tag_name"
        },
        {
          "include": "#template_tag_keyword"
        },
        {
          "include": "#template_var"
        }
      ]
    },
    "template_tag_name": {
      "patterns": [
        {
          "match": "(?:(?:(?<={%)|(?<={%-)|^)\\s*)(else|break|continue)\\b",
          "captures": {
            "1": {
              "name": "keyword.control.liquid"
            }
          }
        },
        {
          "match": "(?:(?:(?<={%)|(?<={%-)|^)\\s*)(if|unless|else|eslif|endunless|endif)\\b",
          "captures": {
            "1": {
              "name": "keyword.control.conditional.liquid"
            }
          }
        },
        {
          "match": "(?:(?:(?<={%)|(?<={%-)|^)\\s*)(for|endfor|cycle|tablerow|endtablerow)\\b",
          "captures": {
            "1": {
              "name": "keyword.control.loop.liquid"
            }
          }
        },
        {
          "match": "(?:(?:(?<={%)|(?<={%-)|^)\\s*)(case|when|endcase)\\b",
          "captures": {
            "1": {
              "name": "keyword.control.switch.liquid"
            }
          }
        },
        {
          "match": "(?:(?:(?<={%)|(?<={%-)|^)\\s*)(\\w+)",
          "captures": {
            "1": {
              "name": "entity.name.tag.liquid"
            }
          }
        }
      ]
    },
    "template_tag_keyword": {
      "patterns": [
        {
          "match": "\\b(reversed|in)\\b",
          "name": "keyword.control.liquid"
        },
        {
          "match": "\\b(cols|offset|limit):",
          "name": "keyword.control.liquid"
        }
      ]
    },
    "object": {
      "begin": "{{-?",
      "end": "-?}}",
      "name": "meta.braces.liquid",
      "beginCaptures": {
        "0": {
          "name": "punctuation.section.braces.begin.liquid"
        }
      },
      "endCaptures": {
        "0": {
          "name": "punctuation.section.braces.end.liquid"
        }
      },
      "patterns": [
        {
          "include": "#template_var"
        }
      ]
    },
    "invalid_range": {
      "match": "\\((.(?!\\.\\.))+\\)",
      "name": "invalid.illegal.range.liquid"
    },
    "range": {
      "begin": "\\(",
      "end": "\\)",
      "name": "meta.range.liquid",
      "beginCaptures": {
        "0": {
          "name": "punctuation.section.parens.begin.liquid"
        }
      },
      "endCaptures": {
        "0": {
          "name": "punctuation.section.parens.end.liquid"
        }
      },
      "patterns": [
        {
          "match": "\\.\\.",
          "name": "punctuation.range.liquid"
        },
        {
          "include": "#variable_lookup"
        },
        {
          "include": "#number"
        }
      ]
    },
    "number": {
      "match": "((-|\\+)\\s*)?[0-9]+(\\.[0-9]+)?",
      "name": "constant.numeric.liquid"
    },
    "string": {
      "patterns": [
        {
          "include": "#string_single"
        },
        {
          "include": "#string_double"
        }
      ]
    },
    "string_double": {
      "begin": "\"",
      "end": "\"",
      "name": "string.quoted.double.liquid"
    },
    "string_single": {
      "begin": "'",
      "end": "'",
      "name": "string.quoted.single.liquid"
    },
    "variable_lookup": {
      "patterns": [
        {
          "match": "\\b(additional_checkout_buttons|address|all_country_option_tags|all_products|article|articles|block|blog|blogs|canonical_url|cart|checkout|collection|collections|comment|content_for_additional_checkout_buttons|content_for_header|content_for_index|content_for_layout|country_option_tags|currency|current_page|current_tags|customer|customer_address|discount_allocation|discount_application|external_video|font|forloop|form|fulfillment|gift_card|handle|image|images|line_item|link|linklist|linklists|location|localization|metafield|model|model_source|order|page|page_description|page_image|page_title|pages|paginate|part|policy|powered_by_link|predictive_search|product|product_option|product_variant|recommendations|request|routes|script|scripts|search|section|selling_plan|selling_plan_allocation|selling_plan_group|settings|shipping_method|shop|shop_locale|store_availability|tablerow|tax_line|template|theme|transaction|unit_price_measurement|variant|video|video_source)\\b",
          "name": "variable.language.liquid"
        },
        {
          "match": "((?<=\\w\\:\\s)\\w+)",
          "name": "variable.parameter.liquid"
        },
        {
          "begin": "(?<=\\w)\\[",
          "beginCaptures": {
            "0": {
              "name": "punctuation.section.brackets.begin.liquid"
            }
          },
          "end": "\\]",
          "endCaptures": {
            "0": {
              "name": "punctuation.section.brackets.end.liquid"
            }
          },
          "name": "meta.brackets.liquid",
          "patterns": [
            {
              "include": "#string"
            }
          ]
        },
        {
          "match": "(?<=\\w\\.)(\\w+)\\b",
          "name": "variable.other.member.liquid"
        },
        {
          "match": "(?<=\\w)\\.(?=\\w)",
          "name": "punctuation.accessor.liquid"
        },
        {
          "match": "(?i)[a-z_]\\w*",
          "name": "variable.other.liquid"
        }
      ]
    },
    "operator": {
      "match": "(?:(?<=\\s)|\\b)(\\=\\=|!\\=|\\>|\\<|\\>\\=|\\<\\=|or|and|contains)(?:(?=\\s)|\\b)",
      "captures": {
        "1": {
          "name": "keyword.operator.expression.liquid"
        }
      }
    },
    "template_var": {
      "patterns": [
        {
          "match": "(\\[)(\\|)(?=[^\\]]*)(?=\\])",
          "captures": {
            "2": {
              "name": "invalid.illegal.filter.liquid"
            },
            "3": {
              "name": "invalid.illegal.filter.liquid"
            }
          }
        },
        {
          "match": "(?<=\\s)(\\+|\\-|\\/|\\*)(?=\\s)",
          "name": "invalid.illegal.filter.liquid"
        },
        {
          "match": "(false|true|nil|blank)",
          "name": "constant.language.liquid"
        },
        {
          "include": "#operator"
        },
        {
          "match": "\\|\\s+(?![\\.0-9])[a-zA-Z0-9_-]+\\:\\s+",
          "name": "support.function.with-args.liquid"
        },
        {
          "match": "\\|\\s+(?![\\.0-9])[a-zA-Z0-9_-]+\\s+",
          "name": "support.function.without-args.liquid"
        },
        {
          "include": "#invalid_range"
        },
        {
          "include": "#range"
        },
        {
          "include": "#number"
        },
        {
          "include": "#string"
        },
        {
          "include": "#variable_lookup"
        }
      ]
    }
  }
}